{"version":3,"sources":["assets\\Script\\Common\\Managers\\ReloadResMgr.js"],"names":["mgr","cc","Class","_dict_urlRes","_dict_headImg","_list_headImg","ctor","getHeadImg","url","callFunc","index","indexOf","splice","loader","load","err","texture","frame","console","log","SpriteFrame","length","lastUrl","pop","removeOneHeadImg","bind","releaseAsset","removeAllImages","module","exports"],"mappings":";;;;;;AAAA;;AAEA,IAAIA,MAAMC,GAAGC,KAAH,CAAS;AACfC,kBAAe,IADA,EACiC;AAChDC,mBAAgB,IAFD,EAEiC;AAChDC,mBAAgB,IAHD;AAIfC,UAAO,gBAAY,CAClB,CALc;AAMf;AACAC,gBAAa,oBAAUC,GAAV,EAAeC,QAAf,EAAyB;AAClC,YAAG,CAAC,KAAKL,aAAT,EAAwB;AACpB,iBAAKA,aAAL,GAAqB,EAArB;AACA,iBAAKC,aAAL,GAAqB,EAArB;AACH;AACD,YAAG,KAAKD,aAAL,CAAmBI,GAAnB,CAAH,EAA4B;AACxB,gBAAGC,QAAH,EAAaA,SAAS,KAAKL,aAAL,CAAmBI,GAAnB,EAAwB,CAAxB,CAAT;AACb,gBAAIE,QAAQ,KAAKL,aAAL,CAAmBM,OAAnB,CAA2BH,GAA3B,CAAZ;AACA,gBAAGE,QAAQ,CAAC,CAAZ,EAAc;AACV,qBAAKL,aAAL,CAAmBO,MAAnB,CAA0BF,KAA1B,EAAgC,CAAhC;AACA,qBAAKL,aAAL,CAAmBO,MAAnB,CAA0B,CAA1B,EAA4B,CAA5B,EAA8BJ,GAA9B;AACH;AACJ,SAPD,MAOM;AACFP,eAAGY,MAAH,CAAUC,IAAV,CAAeN,GAAf,EAAoB,UAAUO,GAAV,EAAeC,OAAf,EAAwB;AACxC,oBAAIC,KAAJ;AACA,oBAAGF,GAAH,EAAO;AACHG,4BAAQC,GAAR,CAAY,6BAA2BJ,GAAvC;AACH,iBAFD,MAEK;AACD,wBAAGC,OAAH,EAAW;AACPC,gCAAM,IAAIhB,GAAGmB,WAAP,CAAmBJ,OAAnB,CAAN;AACA,4BAAGC,KAAH,EAAS;AACL,iCAAKb,aAAL,CAAmBI,GAAnB,IAA0B,CAACS,KAAD,EAAQD,OAAR,CAA1B;AACA,iCAAKX,aAAL,CAAmBO,MAAnB,CAA0B,CAA1B,EAA4B,CAA5B,EAA8BJ,GAA9B;AACA,gCAAG,KAAKH,aAAL,CAAmBgB,MAAnB,GAA4B,EAA/B,EAAkC;AAC9B,oCAAIC,UAAU,KAAKjB,aAAL,CAAmBkB,GAAnB,EAAd;AACA,qCAAKC,gBAAL,CAAsBF,OAAtB;AACH;AACJ;AACJ;AACJ;AACD,oBAAGb,QAAH,EAAaA,SAASQ,KAAT;AAChB,aAlBmB,CAkBlBQ,IAlBkB,CAkBb,IAlBa,CAApB;AAmBH;AACJ,KAxCc;;AA0Cf;AACAD,sBAAmB,0BAAUhB,GAAV,EAAe;AAC9B,YAAG,KAAKJ,aAAL,CAAmBI,GAAnB,CAAH,EAA4B;AACxBP,eAAGY,MAAH,CAAUa,YAAV,CAAuB,KAAKtB,aAAL,CAAmBI,GAAnB,EAAwB,CAAxB,CAAvB;AACAP,eAAGY,MAAH,CAAUa,YAAV,CAAuB,KAAKtB,aAAL,CAAmBI,GAAnB,EAAwB,CAAxB,CAAvB;AACA,mBAAO,KAAKJ,aAAL,CAAmBI,GAAnB,CAAP;AACH;AACJ,KAjDc;;AAmDf;AACAmB,qBAAkB,2BAAY;AAC1B,aAAI,IAAInB,GAAR,IAAe,KAAKJ,aAApB,EAAkC;AAC9BH,eAAGY,MAAH,CAAUa,YAAV,CAAuB,KAAKtB,aAAL,CAAmBI,GAAnB,EAAwB,CAAxB,CAAvB;AACAP,eAAGY,MAAH,CAAUa,YAAV,CAAuB,KAAKtB,aAAL,CAAmBI,GAAnB,EAAwB,CAAxB,CAAvB;AACH;AACJ;AAzDc,CAAT,CAAV;;AA6DAoB,OAAOC,OAAP,GAAiB7B,GAAjB","file":"unknown","sourcesContent":["//资源预加载管理\r\n\r\nvar mgr = cc.Class({\r\n    _dict_urlRes : null,                            //路径资源，不包括头像\r\n    _dict_headImg : null,                           //头像资源\r\n    _list_headImg : null,\r\n    ctor : function () {\r\n    },\r\n    //加载单张头像图片资源\r\n    getHeadImg : function (url, callFunc) {\r\n        if(!this._dict_headImg) {\r\n            this._dict_headImg = {};\r\n            this._list_headImg = [];\r\n        }\r\n        if(this._dict_headImg[url]) {\r\n            if(callFunc) callFunc(this._dict_headImg[url][0]);\r\n            var index = this._list_headImg.indexOf(url);\r\n            if(index > -1){\r\n                this._list_headImg.splice(index,1);\r\n                this._list_headImg.splice(0,0,url);\r\n            }\r\n        } else{\r\n            cc.loader.load(url, function (err, texture) {\r\n                var frame;\r\n                if(err){\r\n                    console.log('request headImg error== '+err)\r\n                }else{\r\n                    if(texture){\r\n                        frame=new cc.SpriteFrame(texture);\r\n                        if(frame){\r\n                            this._dict_headImg[url] = [frame, texture];\r\n                            this._list_headImg.splice(0,0,url);\r\n                            if(this._list_headImg.length > 30){\r\n                                var lastUrl = this._list_headImg.pop();\r\n                                this.removeOneHeadImg(lastUrl);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                if(callFunc) callFunc(frame);\r\n            }.bind(this));\r\n        }\r\n    },\r\n\r\n    //释放单个资源\r\n    removeOneHeadImg : function (url) {\r\n        if(this._dict_headImg[url]) {\r\n            cc.loader.releaseAsset(this._dict_headImg[url][0]);\r\n            cc.loader.releaseAsset(this._dict_headImg[url][1]);\r\n            delete this._dict_headImg[url];\r\n        }\r\n    },\r\n\r\n    //释放所有资源\r\n    removeAllImages : function () {\r\n        for(var url in this._dict_headImg){\r\n            cc.loader.releaseAsset(this._dict_headImg[url][0]);\r\n            cc.loader.releaseAsset(this._dict_headImg[url][1]);\r\n        }\r\n    },\r\n})\r\n\r\n\r\nmodule.exports = mgr;"]}