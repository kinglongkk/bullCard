{"version":3,"sources":["assets\\Script\\Views\\Scene_Grab\\Effects\\Grab_topEffect.js"],"names":["cc","Class","extends","Component","properties","_aniCallFunc","_grabDoneCallFunc","_list_flags","node_aniContainer","default","type","Node","displayName","prefab_startAni","Prefab","prefab_winFlagAni","prefab_grabDoneAni","onLoad","playGameStartAni","callFunc","playStartAni","GG","audioMgr","playSound","aniName","_startGrabAni","instantiate","parent","designSize","view","getDesignResolutionSize","position","p","width","height","getComponent","dragonBones","ArmatureDisplay","addEventListener","EventObject","COMPLETE","_startAniEnd","active","playAnimation","event","forceStopStart","playTouchStartAni","playGrabAni","playGrabDoneAni","userData","_grabDoneAni","_grabDoneAniEnd","pokerInfo","playOneFlag","pos","flag","_getOneFlag","comp","clearFlag","forceStopAllAni","_flagAni","anis","children","aniNode","i","length","clearAll","node","stopAllActions"],"mappings":"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","file":"unknown","sourcesContent":["//放置在最上面的动画特效\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        _aniCallFunc : null,                                //开始动画的回调\r\n        _grabDoneCallFunc : null,                           //结算动画的回调\r\n        _list_flags : null,                                 //胜利特效\r\n\r\n        node_aniContainer : {\r\n            default : null,\r\n            type : cc.Node,\r\n            displayName : '动画容器'\r\n        },\r\n        prefab_startAni : {\r\n            default : null,\r\n            type : cc.Prefab,\r\n            displayName : '开始动画'\r\n        },\r\n        prefab_winFlagAni : {\r\n            default : null,\r\n            type : cc.Prefab,\r\n            displayName : '赢钱旗帜'\r\n        },\r\n        prefab_grabDoneAni : {\r\n            default : null,\r\n            type : cc.Prefab,\r\n            displayName : '押注完成'\r\n        }\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n\r\n    },\r\n\r\n    //开始游戏动画\r\n    playGameStartAni : function (callFunc) {\r\n        this.playStartAni('grab_start',callFunc);\r\n        GG.audioMgr.playSound(13);\r\n    },\r\n\r\n    playStartAni : function (aniName, callFunc) {\r\n        if(!aniName) aniName = '';\r\n        this._aniCallFunc = callFunc;\r\n        if(!this._startGrabAni){\r\n            this._startGrabAni = cc.instantiate(this.prefab_startAni);\r\n            this._startGrabAni.parent = this.node_aniContainer;\r\n\r\n            //ani.scale = G_Config_common.frameScale;\r\n            var designSize = cc.view.getDesignResolutionSize();\r\n            this._startGrabAni.position = cc.p(designSize.width/2, designSize.height/2);\r\n            this._startGrabAni.getComponent(dragonBones.ArmatureDisplay).addEventListener(dragonBones.EventObject.COMPLETE, this._startAniEnd, this);\r\n        }\r\n        this._startGrabAni.active = true;\r\n        //comp = this._startAni.getComponent(dragonBones.ArmatureDisplay);\r\n        this._startGrabAni.getComponent(dragonBones.ArmatureDisplay).playAnimation(aniName, 1);\r\n    },\r\n    _startAniEnd : function (event) {\r\n        if(this._startGrabAni) this._startGrabAni.active = false;\r\n        if(this._aniCallFunc) {\r\n            this._aniCallFunc();\r\n            this._aniCallFunc = null;\r\n        }\r\n    },\r\n    forceStopStart : function () {\r\n        if(this._startGrabAni) this._startGrabAni.active = false;\r\n        this._aniCallFunc = null;\r\n    },\r\n\r\n    //=====================\r\n\r\n    //开始幸运区域投注动画\r\n    playTouchStartAni : function (callFunc) {\r\n        this.playGrabAni('platform_bet',callFunc);\r\n    },\r\n\r\n    //投注完成的动画\r\n    playGrabDoneAni : function (callFunc, userData) {\r\n        this.playGrabAni('platform_betOver',callFunc, userData);\r\n    },\r\n\r\n    playGrabAni : function (aniName, callFunc, userData) {\r\n        if(!aniName) aniName = '';\r\n        this._grabDoneCallFunc = callFunc;\r\n        if(!this._grabDoneAni){\r\n            this._grabDoneAni = cc.instantiate(this.prefab_grabDoneAni);\r\n            this._grabDoneAni.parent = this.node_aniContainer;\r\n\r\n            //this._grabDoneAni.scale = G_Config_common.frameScale;\r\n            var designSize = cc.view.getDesignResolutionSize();\r\n            this._grabDoneAni.position = cc.p(designSize.width/2, designSize.height/2);\r\n            this._grabDoneAni.getComponent(dragonBones.ArmatureDisplay).addEventListener(dragonBones.EventObject.COMPLETE, this._grabDoneAniEnd, this);\r\n        }\r\n        this._grabDoneAni.pokerInfo = userData;\r\n        this._grabDoneAni.active = true;\r\n        this._grabDoneAni.getComponent(dragonBones.ArmatureDisplay).playAnimation(aniName, 1);\r\n    },\r\n    _grabDoneAniEnd : function (event) {\r\n        if(this._grabDoneCallFunc) {\r\n            this._grabDoneCallFunc(this._grabDoneAni.pokerInfo);\r\n            this._grabDoneCallFunc = null;\r\n        }\r\n        if(this._grabDoneAni) this._grabDoneAni.active = false;\r\n    },\r\n\r\n    //=====================\r\n\r\n    playOneFlag : function (pos) {\r\n\r\n        var flag = this._getOneFlag();\r\n        flag.position = pos;\r\n        flag.active = true;\r\n\r\n        var comp = flag.getComponent(dragonBones.ArmatureDisplay);\r\n        // comp.addEventListener(dragonBones.EventObject.COMPLETE, this._startAniEnd, this);\r\n        comp.playAnimation('', 1);\r\n    },\r\n    clearFlag : function () {\r\n        //var flag;\r\n        //for(var i = 0; i < this._list_flags.length; i ++){\r\n        //    flag = this._list_flags[i];\r\n        //    if(flag) flag.active = false;\r\n        //}\r\n        this.forceStopAllAni();\r\n    },\r\n    _getOneFlag : function () {\r\n        if(!this._flagAni){\r\n            this._flagAni = cc.instantiate(this.prefab_winFlagAni);\r\n            this._flagAni.parent = this.node_aniContainer;\r\n            //this._flagAni.scale = G_Config_common.frameScale;\r\n        }\r\n        return this._flagAni\r\n    },\r\n\r\n    forceStopAllAni : function () {\r\n        var anis = this.node_aniContainer.children;\r\n        var aniNode;\r\n        for(var i = 0; i < anis.length; i ++){\r\n            aniNode = anis[i];\r\n            if(aniNode){\r\n                aniNode.active = false;\r\n            }\r\n        }\r\n        this._grabDoneCallFunc = null;\r\n\r\n    },\r\n\r\n    clearAll : function () {\r\n        this.forceStopStart();\r\n        this.forceStopAllAni();\r\n        this.node.stopAllActions();\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n"]}