{"version":3,"sources":["assets\\Script\\Views\\UIComponents\\Prefab_dialog_playerList.js"],"names":["cc","Class","extends","require","properties","label_null","default","type","Label","displayName","onLoad","_super","_dealerItemCompName","dataObj","itemPrefab","prefab_item","lineNum","scrollType","G_TYPE","bag","comp_itemContainer","setData","comp_scroll","getScrollView","node","on","_scrollToBottom","G_Config_common","isLocal","netData","_getLocalData","_setNetData","clearItems","GG","httpMgr","sendHttpRequest","G_DIALOG_URL","playerListUrl","data","bind","showLayer","dataList","str","code","msg","_netDataList","_showListByTouch","_setNull","onceNum","onceList","splice","length","oneData","item","comp","showNum","getShowItemNum","i","getItemByIndex","getComponent","string","hideLayer","G_TOOL","getRandomBool","playerInfo","avatarUrl","nickname","coin","Math","floor","random0To1","push","console","log"],"mappings":"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","file":"unknown","sourcesContent":["//玩家列表的界面\r\n\r\n\r\ncc.Class({\r\n    extends: require('BaseDialog'),\r\n\r\n    properties: {\r\n        label_null : {\r\n            default : null,\r\n            type : cc.Label,\r\n            displayName : '无数据时显示'\r\n        },\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this._super('UI_playerList');\r\n\r\n        this._dealerItemCompName = 'Obj_dialogPlayerListCell';\r\n        var dataObj = {\r\n            itemPrefab : this.prefab_item,\r\n            lineNum : 3,\r\n            scrollType : G_TYPE.scrollType.bag,\r\n        }\r\n        this.comp_itemContainer.setData(dataObj);\r\n\r\n        this.comp_scroll = this.comp_itemContainer.getScrollView();\r\n        this.comp_scroll.node.on('scroll-to-bottom', this._scrollToBottom, this);\r\n    },\r\n\r\n    setData: function() {\r\n        if(G_Config_common.isLocal){\r\n            var netData = this._getLocalData();\r\n            this._setNetData(netData);\r\n        }else {\r\n\r\n            this.comp_itemContainer.clearItems(- 1);\r\n            GG.httpMgr.sendHttpRequest(G_DIALOG_URL.playerListUrl, null, function (data) {\r\n                if(data){\r\n                    this._setNetData(data);\r\n                }\r\n            }.bind(this));\r\n        }\r\n    },\r\n\r\n    _setNetData : function (data) {\r\n        this.showLayer();\r\n        var dataList = data.data,\r\n            str;\r\n        if (data.code == '0') {\r\n            str = data.msg;\r\n        } else {\r\n            str = '';\r\n            this._netDataList = dataList;\r\n            this._showListByTouch();\r\n        }\r\n        this._setNull(str);\r\n    },\r\n\r\n    _showListByTouch : function () {\r\n        var onceNum = 15;\r\n        var onceList = this._netDataList.splice(0, onceNum);\r\n        if(!onceList || onceList.length < 1) return;\r\n        var oneData, item, comp, showNum = this.comp_itemContainer.getShowItemNum();\r\n        for(var i = 0; i < onceNum; i ++){\r\n            oneData = onceList[i];\r\n            if(oneData){\r\n                item = this.comp_itemContainer.getItemByIndex(showNum+i);\r\n                if(item){\r\n                    comp = item.getComponent(this._dealerItemCompName);\r\n                    comp.setData(oneData);\r\n                }\r\n            }\r\n        }\r\n        this.comp_itemContainer.clearItems(showNum + i - 1);\r\n    },\r\n\r\n    _scrollToBottom : function () {\r\n        this._showListByTouch();\r\n    },\r\n\r\n    _setNull : function (msg) {\r\n        this.label_null.string = msg;\r\n    },\r\n    hideLayer : function () {\r\n        this._super();\r\n    },\r\n\r\n    _getLocalData : function () {\r\n        var netData = {};\r\n        netData.data = [];\r\n        netData.code = G_TOOL.getRandomBool() ? 0 : 1;\r\n        if(netData.code == 1){\r\n            // var showNum = Math.floor(cc.random0To1() * 10);\r\n            var showNum = 47;\r\n            for(var i = 0; i < showNum; i ++){\r\n                var playerInfo = {\r\n                    avatarUrl : '',\r\n                    nickname : 'name_'+i,\r\n                    coin : -3 + Math.floor(cc.random0To1()*10),\r\n                }\r\n                netData.data.push(playerInfo);\r\n            }\r\n            console.log(netData.data)\r\n        }\r\n        netData.msg = 'request error'\r\n        return netData\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n"]}