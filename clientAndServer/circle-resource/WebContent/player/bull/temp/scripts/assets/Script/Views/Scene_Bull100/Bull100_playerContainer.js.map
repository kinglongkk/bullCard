{"version":3,"sources":["assets\\Script\\Views\\Scene_Bull100\\Bull100_playerContainer.js"],"names":["cc","Class","extends","require","properties","_dict_playerComp","_playerNum","node_playerContainer","default","type","Node","displayName","node_btnGrabDealer","node_myself","node_dealer","prefab_player","Prefab","comp_seatsContainer","onLoad","_playerCompName","_delaerWordCompName","registerButton","OnClick_grabDealer","getMyselfComp","setIsHandle","event","GG","bull100Mgr","send_getDealerList","setStartInfo","seatInfoList","selfInfo","dealerInfo","dictPlayer","selfID","getPlayer","getPlayerID","listLen","length","seatIndex","onePlayer","content","playerComp","i","playerId","attrName","_addOnePlayer","setPlayerData","bindSeatMyself","siteNum","getSeatsNum","_removeOnePlayer","isDealer","Boolean","setUpDealerBtnEnable","setOwnerInfo","setDealerInfo","setGoldValue","coin","setIsDealer","setHandleInfo","newDealerInfo","usableBalance","getDealerComp","onePlayerInsert","playerData","reg","test","_hidePlayer","targetIndex","playerID","siteIndex","player","instantiate","parent","size","G_TOOL","adaptSize","width","height","position","addOnePlayer","getComponent","getIsShow","hidePlayer","onePlayerLeave","showGoldChangeEffect","showGoldChange","flyWinGold","winDict","isMoveGold","recordDict","comp","getBetRecord","newDict","_getWinGoldDict","_moveGold","getWorldPos","getIdleBetting","getIdleBettingPos","goldContainer","getGoldContainer","isFly","recoverAllGold","audioMgr","playSound","tableType","tableIndex","recoverDict","targetPos","goldNum","flyDataList","G_OBJ","data_flyGold_tableToPlayer","tableToPlayer","setMyselfIsShow","isShow","active","isEnable","setBtnEnable","getDealerPokerPos","getMyselfEffectComp","myselfComp","child","node","getChildByName","getMyselfPos","getDealerWordEffectComp","dealerComp","getPlayerComp","clearAll"],"mappings":"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","file":"unknown","sourcesContent":["//所有玩家容器管理\r\n\r\n//座位索引seatIndex是从1开始的\r\n\r\n//var playerData = {\r\n//    nickname : content.nickname,\r\n//    icon : content.icon,\r\n//    playerId : content.playerId,\r\n//    coin : content.coin,\r\n//    moneyChoose : 0,\r\n//    seatIndex : seatIndex\r\n//}\r\n\r\ncc.Class({\r\n    extends: require('AutoDealing'),\r\n\r\n    properties: {\r\n        _dict_playerComp : null,                                                        //座位上的玩家脚本\r\n        _playerNum : null,                                                               //场上的玩家数量\r\n\r\n        node_playerContainer : {                                                          //所有玩家的容器，庄家和自己除外\r\n            default : null,\r\n            type : cc.Node,\r\n            displayName : '所有玩家容器'\r\n        },\r\n        node_btnGrabDealer : {                                                           //抢庄按钮\r\n            default : null,\r\n            type : cc.Node,\r\n            displayName : '抢庄按钮'\r\n        },\r\n        node_myself : {\r\n            default : null,\r\n            type : cc.Node,\r\n            displayName : '玩家自己'\r\n        },\r\n        node_dealer : {\r\n            default : null,\r\n            type : cc.Node,\r\n            displayName : '庄家'\r\n        },\r\n        prefab_player : {\r\n            default : null,\r\n            type : cc.Prefab,\r\n            displayName : '座位上的玩家'\r\n        },\r\n        comp_seatsContainer : {\r\n            default : null,\r\n            type : require('Obj_seatsContainer'),\r\n            displayName : '座位容器'\r\n        },\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this._dict_playerComp = {};\r\n        this._playerNum = 0;\r\n        this._playerCompName = 'Bull100_playerBlock';\r\n        this._delaerWordCompName = 'Obj_dealerWordEffect';\r\n        this.registerButton(this.node_btnGrabDealer, this.OnClick_grabDealer, this);\r\n\r\n        this.getMyselfComp().setIsHandle(true);\r\n    },\r\n\r\n    //点击了上庄按钮\r\n    OnClick_grabDealer : function (event) {\r\n        GG.bull100Mgr.send_getDealerList();\r\n    },\r\n\r\n    //seatInfoList：座位上的玩家；selfInfo自己；dealerInfo庄家\r\n    setStartInfo : function (seatInfoList, selfInfo, dealerInfo) {\r\n        //整理座位信息\r\n        var dictPlayer = {};\r\n        var selfID = GG.getPlayer().getPlayerID();\r\n        var listLen = seatInfoList.length, seatIndex, onePlayer, content, playerComp;\r\n        for(var i = 0; i < listLen; i ++){\r\n            onePlayer = seatInfoList[i];\r\n            seatIndex = onePlayer['seatIndex'];\r\n            content = onePlayer['player'];\r\n            content.seatIndex = seatIndex;\r\n            dictPlayer[seatIndex] = content;\r\n        }\r\n        //根据信息控制位置上玩家的显隐\r\n        //显示有数据的玩家\r\n        for(var seatIndex in dictPlayer){\r\n            content = dictPlayer[seatIndex];\r\n            //从列表中获取属于自己的信息\r\n            if(content && content.playerId == selfID) {\r\n                for(var attrName in content){\r\n                    if(attrName == 'seatIndex' && content[attrName] == 0) continue;\r\n                    selfInfo[attrName] = content[attrName];\r\n                }\r\n            }\r\n            //座位号从1开始\r\n            if(seatIndex < 1) continue;\r\n            //有玩家数据\r\n            playerComp = this._addOnePlayer(seatIndex);\r\n            if(playerComp) {\r\n                playerComp.setPlayerData(content);\r\n                if(content && content.playerId == selfID) this.getMyselfComp().bindSeatMyself(playerComp);\r\n            }\r\n        }\r\n        //隐藏没有数据的位置\r\n        var siteNum = this.comp_seatsContainer.getSeatsNum();\r\n        for(var i = 0; i < siteNum; i ++){\r\n            seatIndex = i+1;\r\n            if(!dictPlayer[seatIndex]) this._removeOnePlayer(seatIndex);\r\n        }\r\n        //从庄家数据中获取玩家自己的数据\r\n        var isDealer = Boolean(selfID == dealerInfo.playerId);\r\n        selfInfo.isDealer = isDealer;\r\n        if (selfInfo.isDealer) {\r\n            for (var attrName in dealerInfo) {\r\n                selfInfo[attrName] = dealerInfo[attrName];\r\n            }\r\n            //庄家上庄按钮不可用\r\n            this.setUpDealerBtnEnable(false);\r\n        } else {\r\n            //玩家上庄按钮可用\r\n            this.setUpDealerBtnEnable(true);\r\n            //if(!GG.bull100Mgr.checkMyselfInfo(seatInfoList)) return;\r\n        }\r\n        if(selfInfo.playerId) this.setOwnerInfo(selfInfo);\r\n        this.setDealerInfo(dealerInfo);\r\n\r\n        //当前自己是庄家的时候自己玩家需要显示的是可用余额而不是全额\r\n        if(isDealer){\r\n            //因为新的机制已经没有给予玩家的信息，为了更新金额所以只能从庄家信息中计算\r\n            this.getMyselfComp().setGoldValue(selfInfo.coin);\r\n        }\r\n        this.getMyselfComp().setIsDealer(isDealer);\r\n    },\r\n\r\n    setOwnerInfo : function (selfInfo) {\r\n        this.getMyselfComp().setPlayerData(selfInfo);\r\n        this.getMyselfComp().setHandleInfo(selfInfo);\r\n    },\r\n    setDealerInfo : function (dealerInfo) {\r\n        var newDealerInfo = {};\r\n        for(var attrName in dealerInfo){\r\n            newDealerInfo[attrName] = dealerInfo[attrName];\r\n        }\r\n        newDealerInfo.coin = dealerInfo.usableBalance;\r\n        this.getDealerComp().setPlayerData(newDealerInfo);\r\n    },\r\n\r\n    //有一个玩家中途进入\r\n    onePlayerInsert : function (seatIndex, playerData) {\r\n        var reg = /^\\+?[1-9][0-9]*$/;\r\n        if (reg.test(seatIndex)) {\r\n            playerData.seatIndex = seatIndex;\r\n            this._hidePlayer(seatIndex, playerData.playerId);\r\n            var playerComp = this._addOnePlayer(seatIndex);\r\n            if(playerComp) playerComp.setPlayerData(playerData);\r\n        }\r\n    },\r\n\r\n    //删除重复的玩家，结束本局时候，重复进出房间会出现多个同样玩家\r\n    _hidePlayer : function (targetIndex, playerID) {\r\n        var playerComp;\r\n        for(var seatIndex in this._dict_playerComp){\r\n            playerComp = this._dict_playerComp[seatIndex];\r\n            if(seatIndex == targetIndex){\r\n                //找到位置\r\n                //if(playerComp) playerComp.setPlayerData(playerData);\r\n            }else{\r\n                if(playerComp && playerComp.getPlayerID() == playerID){\r\n                    this._removeOnePlayer(seatIndex);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    //增加一个上场玩家\r\n    _addOnePlayer : function (siteIndex) {\r\n        var playerComp = this._dict_playerComp[siteIndex];\r\n        if(!playerComp){\r\n            var player = cc.instantiate(this.prefab_player);\r\n            player.parent = this.node_playerContainer;\r\n            var size = G_TOOL.adaptSize(player.width, player.height);\r\n            player.width = size.width;\r\n            player.height = size.height;\r\n            player.position = this.comp_seatsContainer.addOnePlayer(siteIndex);\r\n            playerComp = player.getComponent(this._playerCompName);\r\n            this._dict_playerComp[siteIndex] = playerComp;\r\n        }else{\r\n            this.comp_seatsContainer.addOnePlayer(siteIndex);\r\n        }\r\n        this._playerNum += 1;\r\n        return playerComp;\r\n    },\r\n    //一个玩家离场\r\n    _removeOnePlayer : function (siteIndex) {\r\n        var playerComp = this._dict_playerComp[siteIndex];\r\n        if(!playerComp || !playerComp.getIsShow()) return\r\n        playerComp.hidePlayer();\r\n        this.comp_seatsContainer.onePlayerLeave(siteIndex);\r\n        this._playerNum -= 1;\r\n    },\r\n\r\n    //显示所有玩家的金币增减特效\r\n    showGoldChangeEffect : function () {\r\n        var player;\r\n        for(var siteIndex in this._dict_playerComp){\r\n            player = this._dict_playerComp[siteIndex];\r\n            if(player){\r\n                player.showGoldChange();\r\n            }\r\n        }\r\n        //mine\r\n        this.getMyselfComp().showGoldChange();\r\n    },\r\n\r\n    //=======================\r\n\r\n    //场上的金币结算  winDict = {0:1, 2:1, 4:1},  {桌子索引：是否胜利}\r\n    flyWinGold : function (winDict) {\r\n        var isMoveGold = false;\r\n        //自己的金币结算\r\n        var recordDict;\r\n        var comp = this.getMyselfComp();\r\n        recordDict = comp.getBetRecord();\r\n        if(recordDict){\r\n            var newDict = this._getWinGoldDict(winDict, recordDict);\r\n            this._moveGold(newDict, comp.getWorldPos());\r\n        }\r\n        //其他玩家的胜利金币移动\r\n        var playerComp;\r\n        for(var seatIndex in this._dict_playerComp){\r\n            playerComp = this._dict_playerComp[seatIndex];\r\n            if(playerComp.getPlayerID() == GG.getPlayerID()) continue;\r\n            if(playerComp && playerComp.getIsShow()){\r\n                recordDict = playerComp.getBetRecord();\r\n                if(recordDict){\r\n                    isMoveGold = true;\r\n                    var newDict = this._getWinGoldDict(winDict, recordDict);\r\n                    this._moveGold(newDict, playerComp.getWorldPos());\r\n                }\r\n            }\r\n        }\r\n        //是否有吃瓜群众赢钱\r\n        recordDict = GG.bull100Mgr.getIdleBetting();\r\n        if(recordDict){\r\n            isMoveGold = true;\r\n            var newDict = this._getWinGoldDict(winDict, recordDict);\r\n            this._moveGold(newDict, GG.bull100Mgr.getIdleBettingPos());\r\n        }\r\n\r\n        //庄家回收剩余的金币\r\n        var goldContainer = this.getGoldContainer();\r\n        var isFly = goldContainer.recoverAllGold(this.getDealerComp().getWorldPos());\r\n        if(isFly) isMoveGold = true;\r\n\r\n        if(isMoveGold) GG.audioMgr.playSound(18);\r\n    },\r\n\r\n    _getWinGoldDict : function (winDict, recordDict) {\r\n        var tableType, newDict = {};\r\n        for(var tableIndex in winDict){\r\n            tableType = winDict[tableIndex];\r\n            if(tableType && recordDict[tableIndex]){\r\n                newDict[tableIndex] = recordDict[tableIndex];\r\n            }\r\n        }\r\n        return newDict\r\n    },\r\n    //金币结算移动\r\n    _moveGold : function (recoverDict, targetPos) {\r\n        var goldNum, goldContainer = this.getGoldContainer();\r\n        for(var tableIndex in recoverDict){\r\n            goldNum = recoverDict[tableIndex];\r\n\r\n            var flyDataList = G_OBJ.data_flyGold_tableToPlayer();\r\n            flyDataList.tableIndex = tableIndex;\r\n            flyDataList.goldNum = goldNum;\r\n            flyDataList.targetPos = targetPos;\r\n            goldContainer.tableToPlayer(flyDataList);\r\n        }\r\n    },\r\n\r\n    //设置玩家操作位置的显隐\r\n    setMyselfIsShow : function (isShow) {\r\n        this.node_myself.active = isShow;\r\n    },\r\n    //设置抢庄按钮是否可用\r\n    setUpDealerBtnEnable : function (isEnable) {\r\n        this.setBtnEnable(this.node_btnGrabDealer,isEnable);\r\n    },\r\n\r\n    //=======================\r\n\r\n    //获取庄家的卡牌位置\r\n    getDealerPokerPos : function () {\r\n        return this.getDealerComp().getDealerPokerPos();\r\n    },\r\n    //获取玩家自己\r\n    getMyselfComp : function () {\r\n        return this.node_myself.getComponent(this._playerCompName)\r\n    },\r\n    //获取玩家庄字特效\r\n    getMyselfEffectComp : function () {\r\n        var myselfComp = this.getMyselfComp();\r\n        var child = myselfComp.node.getChildByName('bankerMark');\r\n        var comp;\r\n        if(child){\r\n            comp = child.getComponent(this._delaerWordCompName);\r\n        }\r\n        return comp\r\n    },\r\n    getMyselfPos : function () {\r\n        return this.node_myself.position\r\n    },\r\n    //获取庄家\r\n    getDealerComp : function () {\r\n        return this.node_dealer.getComponent(this._playerCompName)\r\n    },\r\n    //获取庄家庄字特效\r\n    getDealerWordEffectComp : function () {\r\n        var dealerComp = this.getDealerComp();\r\n        var child = dealerComp.node.getChildByName('bankerMark');\r\n        var comp;\r\n        if(child){\r\n            comp = child.getComponent(this._delaerWordCompName);\r\n        }\r\n        return comp\r\n    },\r\n    //获取在座位上的玩家脚本\r\n    getPlayerComp : function (siteIndex) {\r\n        return this._dict_playerComp[siteIndex];\r\n    },\r\n    //获取金币容器\r\n    getGoldContainer : function () {\r\n        return GG.bull100Mgr.getGoldContainer();\r\n    },\r\n\r\n    //清理所有\r\n    clearAll : function () {\r\n        for(var seatIndex in this._dict_playerComp){\r\n            this._removeOnePlayer(seatIndex);\r\n        }\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n"]}