{"version":3,"sources":["assets\\Script\\Objects\\Obj_dealerListSlider.js"],"names":["cc","Class","extends","Component","properties","_sliderComp","_ui_moveNum","_label_moveNum","_oneWordWidth","_offNum","_curMoveNum","_handleNode","_idleMoney","node_lightLine","default","type","Node","displayName","node_touchLimit","onLoad","node","getComponent","Slider","_baseWordNum","_time_numHide","_addSliderEvent","_initMoveNum","_resetLightLine","on","_sliderMove","EventType","TOUCH_END","sliderEnd","handle","getChildByName","btn","Button","TOUCH_CANCEL","children","length","Label","width","setData","myGold","offGold","minLimitGold","_setTouchLimit","_playerGold","_minNum","firstNum","_setGoldProgress","_setUIMoveNum","_setMoveNumShow","_isShow","event","num","progress","changeNum","Math","floor","_addTimeHide","value","len","string","getMoveNum","isShow","stopAllActions","opacity","active","runAction","sequence","fadeOut","callFunc","isLimit","TOUCH_START","_onClick_Touch","off"],"mappings":"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","file":"unknown","sourcesContent":["//上庄进度条处理\r\n\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        _sliderComp : null,                                                                                             //进度条组件\r\n        _ui_moveNum : null,                                                                                             //移动的数字\r\n        _label_moveNum : null,                                                                                          //移动的数字\r\n        _oneWordWidth : null,                                                                                           //一个数字的长度\r\n        _offNum : null,                                                                                                  //间隔数额\r\n        _curMoveNum : null,                                                                                             //当前的移动到的数额\r\n        _handleNode : null,                                                                                             //滑动的点\r\n        _idleMoney : null,                                                                                               //空闲的资金，如果有则可以增大上庄金额\r\n\r\n        node_lightLine : {\r\n            default : null,\r\n            type : cc.Node,\r\n            displayName : '进度条'\r\n        },\r\n        node_touchLimit : {\r\n            default : null,\r\n            type : cc.Node,\r\n            displayName : '进度条触摸吞噬层'\r\n        },\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this._sliderComp = this.node.getComponent(cc.Slider);\r\n\r\n        this._baseWordNum = 4.5;\r\n        this._time_numHide = 2;\r\n\r\n        this._addSliderEvent();\r\n        this._initMoveNum();\r\n        this._resetLightLine();\r\n    },\r\n    //增加监听事件\r\n    _addSliderEvent : function () {\r\n        this._sliderComp.node.on('slide', this._sliderMove, this);\r\n        this._sliderComp.node.on(cc.Node.EventType.TOUCH_END, this.sliderEnd, this);\r\n\r\n        var handle = this.node.getChildByName('Handle');\r\n        if(handle){\r\n            var btn = handle.getComponent(cc.Button);\r\n            handle.on(cc.Node.EventType.TOUCH_CANCEL, this.sliderEnd, this);\r\n        }\r\n    },\r\n    //初始化可操作节点\r\n    _initMoveNum : function () {\r\n        var handle = this.node.getChildByName('Handle');\r\n        if(handle.children.length > 0){\r\n            this._ui_moveNum = handle.children[0];\r\n            this._label_moveNum = this._ui_moveNum.children[0].getComponent(cc.Label);\r\n            this._oneWordWidth = this._ui_moveNum.width / this._baseWordNum;\r\n        }\r\n    },\r\n\r\n    //myGold: 自己拥有的金币; offGold：移动金币的差值，minLimitGold：最小金币限额\r\n    setData : function (myGold, offGold, minLimitGold) {\r\n        if(!myGold) {\r\n            this._setTouchLimit(true);\r\n            return;\r\n        }\r\n        this._playerGold = myGold;\r\n        this._offNum = offGold;\r\n        this._minNum = minLimitGold;\r\n        this._idleMoney = this._playerGold - this._minNum;\r\n\r\n        var firstNum;\r\n        if(this._playerGold < this._minNum){\r\n            //钱不足\r\n            this._setTouchLimit(true);\r\n            firstNum = this._minNum;\r\n            this._setGoldProgress(0)\r\n        }else if(this._playerGold < (this._minNum + this._offNum)){\r\n            this._setTouchLimit(true);\r\n            this._setGoldProgress(1)\r\n            this._resetLightLine();\r\n            firstNum = this._minNum;\r\n        }else{\r\n            this._setTouchLimit(false);\r\n            firstNum = this._minNum;\r\n            this._setGoldProgress(0)\r\n        }\r\n        this._setUIMoveNum(firstNum);\r\n        this._setMoveNumShow(true);\r\n        this._isShow = true;\r\n    },\r\n\r\n    //移动回调，如果进度条有移动，则这里会被调用\r\n    _sliderMove : function (event) {\r\n        //console.log(event)\r\n        this._resetLightLine();\r\n        //显示数值\r\n        var num = this._idleMoney * this._sliderComp.progress;\r\n        var changeNum = Math.floor(num/this._offNum)*this._offNum;\r\n        this._setUIMoveNum(changeNum+this._minNum);\r\n\r\n        this._setMoveNumShow(true);\r\n    },\r\n    sliderEnd : function () {\r\n        this._addTimeHide();\r\n    },\r\n\r\n    //设置进度\r\n    _setGoldProgress : function (value) {\r\n        this._sliderComp.progress = value;\r\n        this._resetLightLine();\r\n    },\r\n\r\n    //设置进度条滑动的表现\r\n    _resetLightLine : function () {\r\n        this.node_lightLine.width = this.node.width*this._sliderComp.progress;\r\n    },\r\n\r\n    //=================================滑动点上的数字显示\r\n\r\n    //显示移动在进度条上的数值\r\n    _setUIMoveNum : function (num) {\r\n        this._curMoveNum = num;\r\n        num += '';\r\n        var len = num.length;\r\n        this._ui_moveNum.width = len * this._oneWordWidth\r\n        this._label_moveNum.string = num;\r\n\r\n        //this._ui_moveNum.x = this._handleNode.x;\r\n    },\r\n\r\n    //获取选择数值\r\n    getMoveNum : function () {\r\n        return this._curMoveNum;\r\n    },\r\n\r\n    //控制进度条上面的数值的显隐\r\n    _setMoveNumShow : function (isShow) {\r\n        if(this._ui_moveNum) {\r\n            this._ui_moveNum.stopAllActions();\r\n            if(isShow){\r\n                this._ui_moveNum.opacity = 255;\r\n                this._ui_moveNum.active = true;\r\n            }else this._ui_moveNum.active = false;\r\n        }\r\n    },\r\n\r\n    _addTimeHide : function () {\r\n        if(this._ui_moveNum) {\r\n            this._ui_moveNum.stopAllActions();\r\n            this._ui_moveNum.runAction(cc.sequence(cc.fadeOut(this._time_numHide), cc.callFunc(function () {\r\n                this._setMoveNumShow(false);\r\n            }, this)));\r\n        }\r\n    },\r\n\r\n    //==========================================\r\n\r\n    _setTouchLimit : function (isLimit) {\r\n        if (isLimit) {\r\n            this.node_touchLimit.active = true;\r\n            this.node_touchLimit.on(cc.Node.EventType.TOUCH_START, this._onClick_Touch, this);\r\n        } else {\r\n            this.node_touchLimit.off(cc.Node.EventType.TOUCH_START, this._onClick_Touch, this);\r\n            this.node_touchLimit.active = false;\r\n        }\r\n    },\r\n    _onClick_Touch : function () {\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n"]}