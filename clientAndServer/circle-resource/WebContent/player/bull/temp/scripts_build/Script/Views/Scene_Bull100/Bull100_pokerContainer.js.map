{"version":3,"sources":["assets\\Script\\Views\\Scene_Bull100\\Bull100_pokerContainer.js"],"names":["cc","Class","extends","Component","properties","_pool","_startPos","_pokerNum","_dict_pokerGroup","_pokerSize","_coverPokerCallFunc","_dict_winList","_list_pokerResultValue","_list_pokerPos","_maxPokerNum","_list_hidePokers","prefab_poker","Prefab","onLoad","_pokerCompName","_offPokerX","_offGiveTime","_offGroupTime","_pokerMoveTime","_groupPokerNum","_pokerMoveTime2","_pokerScale","_openInterval","giveCoverPokers","posList","callFunc","isOverAni","length","_clearPokers","_pokerData","concat","_showPokerGroup","_givePokerGroup","pos","posListLen","poker","curNum","i","j","_getOnePoker","position","p","x","y","height","_getGroupNum","push","_flyNum","targetPos","pop","_flyOnePoker","GG","audioMgr","playSound","act1","delayTime","needPos","_pokerOffY","act2","moveTo","G_TOOL","getUniformTime","stopAllActions","runAction","sequence","_onePokerFlyEnd","target","_sortPokerOff","act","node","pokerList","len","moveBy","setPokersData","dataList","pokerValueList","pokerGroup","pokerData","pokerNodeList","pokerGroupNum","_setOnePokerInfo","pokerIndex","isOpen","pokerInfo","G_DATA","getPokerInfo","pokerComp","getComponent","setPokerInfo","pokerType","pokerValue","openPokers","dict","_openGroupIndex","_openOneGroup","comp","_openCallBack","bind","openPoker","tableIndex","minIndex","bull100Mgr","getMinTableIndex","bigIndex","getBigTableIndex","curIndex","showTableWin","value","showPokerResult","width","audioID","pokerNode","instantiate","getPokerSize","parent","scale","active","_getStartPos","showPokerNegative","_removePoker","clearAllActions","_deletePokers","pokers","children","pokerNum","getBottomTipPos","Math","floor","getIsGivePokerEnd","Boolean","clearAll","onDestroy","clear"],"mappings":"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","file":"unknown","sourcesContent":["//卡牌容器\r\n\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        _pool : null,                                                           //对象容器\r\n        _startPos : null,                                                       //开始位置\r\n        _pokerNum : null,                                                       //存在的卡牌数量\r\n        _dict_pokerGroup : null,                                               //卡牌对象牌组\r\n        _pokerSize : null,                                                      //卡牌的宽高\r\n        _coverPokerCallFunc : null,                                            //所有背面卡牌发完\r\n        _dict_winList : null,                                                   //胜利的卡牌\r\n        _list_pokerResultValue : null,                                         //卡牌开牌后的结果数值\r\n        _list_pokerPos : null,                                                   //卡牌位置信息\r\n        _maxPokerNum : null,                                                    //最大的卡牌数量\r\n        _list_hidePokers : null,                                                //隐藏的卡牌列表\r\n\r\n        prefab_poker : cc.Prefab,                                               //卡牌容器\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this._pokerCompName = 'Obj_poker';\r\n        this._list_hidePokers = [];\r\n        this._pokerNum = 0;\r\n\r\n        //卡牌间隔\r\n        this._offPokerX = 20;\r\n        //发牌时间间隔\r\n        this._offGiveTime = 0.08;\r\n        //每副牌之间的时间间隔\r\n        this._offGroupTime = 0.3;\r\n        //单张卡牌移动时间\r\n        this._pokerMoveTime = 0.8;\r\n        //一副牌有几张\r\n        this._groupPokerNum = 5;\r\n        //卡牌第二个动作移动时间\r\n        this._pokerMoveTime2 = 0.2;\r\n        //对卡牌进行缩放\r\n        this._pokerScale = 1;\r\n        //开牌间隔\r\n        this._openInterval = 0.6;\r\n    },\r\n\r\n    //分发盖住的牌\r\n    giveCoverPokers : function (posList, callFunc, isOverAni) {\r\n        this._coverPokerCallFunc = callFunc;\r\n        this._maxPokerNum = posList.length * this._groupPokerNum;\r\n        this._clearPokers();\r\n        this._pokerData = null;\r\n        if(posList) {\r\n            this._list_pokerPos = posList;\r\n            this._pokerData = this._list_pokerPos.concat([]);\r\n        }\r\n        if(isOverAni) this._showPokerGroup();\r\n        else {\r\n            this._givePokerGroup();\r\n        }\r\n    },\r\n\r\n    //-------------------------------\r\n\r\n    //直接将需要的牌显示出来，不做动画\r\n    _showPokerGroup : function () {\r\n        var pos, posListLen = this._pokerData.length, poker, curNum;\r\n        for(var i = posListLen-1; i >= 0; i --){\r\n            pos = this._pokerData[i];\r\n            for(var j = 0; j < this._groupPokerNum; j ++){\r\n                poker = this._getOnePoker();\r\n                if(poker) {\r\n                    curNum = this._pokerNum%this._groupPokerNum;\r\n                    poker.position = cc.p(pos.x + this._offPokerX*curNum, pos.y-this._pokerSize.height*this._pokerScale*0.5);\r\n                    //poker.position = G_TOOL.adaptPos(poker.position);\r\n                    if(!this._dict_pokerGroup[this._getGroupNum()]) this._dict_pokerGroup[this._getGroupNum()] = [];\r\n                    this._dict_pokerGroup[this._getGroupNum()].push(poker);\r\n                    this._pokerNum += 1;\r\n                }\r\n            }\r\n        }\r\n        if(this._coverPokerCallFunc){\r\n            this._coverPokerCallFunc();\r\n            this._coverPokerCallFunc = null;\r\n        }\r\n    },\r\n\r\n    //--------------------------------\r\n    //发一副牌\r\n    _givePokerGroup : function () {\r\n        if(!this._pokerData || this._pokerData.length < 1) {\r\n            //所有卡牌发完\r\n            if(this._coverPokerCallFunc){\r\n                this._coverPokerCallFunc();\r\n                this._coverPokerCallFunc = null;\r\n            }\r\n            return;\r\n        }\r\n\r\n        this._flyNum = 5;\r\n        this._dict_pokerGroup[this._getGroupNum()] = [];\r\n        var targetPos = this._pokerData.pop();\r\n        for(var i = 0; i < this._groupPokerNum; i ++){\r\n            //最后坐标需要计算卡牌的宽高\r\n            this._flyOnePoker(targetPos);\r\n        }\r\n        GG.audioMgr.playSound(14);\r\n    },\r\n    //移动单张牌\r\n    _flyOnePoker : function (targetPos) {\r\n        var poker = this._getOnePoker();\r\n        if(!targetPos || !poker) return;\r\n        var curNum = this._pokerNum%this._groupPokerNum;\r\n        var act1 = cc.delayTime(this._offGiveTime*curNum);\r\n\r\n        var needPos = cc.p(targetPos.x, targetPos.y-this._pokerOffY);\r\n        var act2 = cc.moveTo(G_TOOL.getUniformTime(poker.position, needPos, this._pokerMoveTime), needPos);\r\n        poker.stopAllActions();\r\n        poker.runAction(cc.sequence(act1,act2, cc.callFunc(this._onePokerFlyEnd, this)));\r\n        this._dict_pokerGroup[this._getGroupNum()].push(poker);\r\n        this._pokerNum += 1;\r\n    },\r\n    _onePokerFlyEnd : function (target) {\r\n        //有一张卡牌移动结束\r\n        this._flyNum -= 1;\r\n        if(this._flyNum < 1) {\r\n            this._sortPokerOff();\r\n            var act = cc.delayTime(this._offGroupTime);\r\n            this.node.runAction(cc.sequence(act,cc.callFunc(this._givePokerGroup, this)));\r\n        }\r\n    },\r\n    //把发好的牌散开\r\n    _sortPokerOff : function () {\r\n        var pokerList = this._dict_pokerGroup[this._getGroupNum()-1];\r\n        var len = pokerList.length;\r\n        var poker;\r\n        for(var i = 0; i < len; i ++){\r\n            poker = pokerList[i];\r\n            if(!poker) continue;\r\n            poker.stopAllActions();\r\n            poker.runAction(cc.moveBy(this._pokerMoveTime2, this._offPokerX*i,0));;\r\n        }\r\n    },\r\n\r\n    //设置卡牌的信息\r\n    setPokersData : function (dataList, pokerValueList) {\r\n        this._list_pokerResultValue = pokerValueList;\r\n        var pokerGroup, pokerData, pokerNodeList, pokerGroupNum = this._getGroupNum();\r\n        for(var i = 0; i < pokerGroupNum; i ++){\r\n            pokerGroup = dataList[i];\r\n            pokerNodeList = this._dict_pokerGroup[i];\r\n            if(pokerGroup){\r\n                for(var j = 0; j < pokerGroup.length; j ++){\r\n                    pokerData = pokerGroup[j];\r\n                    this._setOnePokerInfo(pokerNodeList[j], pokerData.pokerIndex, pokerData.isOpen);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _setOnePokerInfo : function (poker, pokerIndex, isOpen) {\r\n        var pokerInfo = G_DATA.getPokerInfo(pokerIndex);\r\n        var pokerComp = poker.getComponent(this._pokerCompName);\r\n        pokerComp.setPokerInfo(pokerInfo.pokerType, pokerInfo.pokerValue, isOpen);\r\n    },\r\n\r\n    //开牌\r\n    openPokers : function (dict) {\r\n        this._dict_winList = dict;\r\n        this._openGroupIndex = 0;\r\n        this._openOneGroup();\r\n    },\r\n    //开启一副牌\r\n    _openOneGroup : function () {\r\n        if(this._pokerNum < 1){\r\n            return\r\n        }\r\n        var pokerList = this._dict_pokerGroup[this._openGroupIndex];\r\n        if(!pokerList){\r\n            //卡牌全部打开\r\n            return\r\n        }\r\n        var comp, pokerInfo, callFunc = this._openCallBack.bind(this);\r\n        for(var i = 0; i < pokerList.length; i ++){\r\n            comp = pokerList[i].getComponent(this._pokerCompName);\r\n            comp.openPoker(callFunc);\r\n            callFunc = null;\r\n        }\r\n        this._openGroupIndex += 1;\r\n        GG.audioMgr.playSound(16);\r\n        //this.node.runAction(cc.sequence(cc.delayTime(this._openInterval), cc.callFunc(this._openOneGroup, this)));\r\n    },\r\n    _openCallBack : function () {\r\n        if(this._openGroupIndex > 1 && this._dict_winList){\r\n            var tableIndex = this._openGroupIndex-2;\r\n            var minIndex = GG.bull100Mgr.getMinTableIndex(tableIndex);\r\n            var bigIndex = GG.bull100Mgr.getBigTableIndex(tableIndex);\r\n            var curIndex = this._dict_winList[bigIndex] ? bigIndex : minIndex;\r\n            GG.bull100Mgr.showTableWin(curIndex, this._dict_winList[curIndex]);\r\n        }\r\n        //显示这副卡牌的值\r\n        var value = this._list_pokerResultValue[this._openGroupIndex-1];\r\n        var pos = this._list_pokerPos[this._list_pokerPos.length - this._openGroupIndex];\r\n        GG.bull100Mgr.showPokerResult(cc.p(pos.x+this._pokerSize.width*0.5, pos.y-+this._pokerSize.height*0.5), value);\r\n        var audioID = value == 0 ? 11 : value;\r\n        GG.audioMgr.playSound(audioID);\r\n        //打开下一付牌\r\n        this._openOneGroup();\r\n    },\r\n\r\n    //增加一张卡牌\r\n    _getOnePoker : function () {\r\n        if(!this.prefab_poker) return null;\r\n        //if(!this._pool) this._pool = new cc.NodePool('Bull100_pokerContainer');\r\n\r\n        var pokerNode = this._list_hidePokers.pop();\r\n        if(!pokerNode){\r\n            pokerNode = cc.instantiate(this.prefab_poker);\r\n            if(!this._pokerSize) {\r\n                this._pokerSize = pokerNode.getComponent(this._pokerCompName).getPokerSize();\r\n                this._pokerOffY = this._pokerSize.height*this._pokerScale*0.5;\r\n            }\r\n            pokerNode.parent = this.node;\r\n            pokerNode.scale = this._pokerScale;\r\n        }\r\n        pokerNode.stopAllActions();\r\n        pokerNode.active = true;\r\n        pokerNode.position = this._getStartPos();\r\n        pokerNode.getComponent(this._pokerCompName).showPokerNegative();\r\n        return pokerNode;\r\n    },\r\n\r\n    _removePoker : function (pokerNode) {\r\n        //pokerNode.stopAllActions()\r\n        pokerNode.getComponent(this._pokerCompName).clearAllActions();\r\n        pokerNode.getComponent(this._pokerCompName).showPokerNegative();\r\n        pokerNode.active = false;\r\n        //this._pool.put(pokerNode);\r\n        this._list_hidePokers.push(pokerNode);\r\n    },\r\n\r\n    _deletePokers : function () {\r\n        //var poker = this.node.children;\r\n        //for(var key in poker){\r\n        //    poker[key].destroy();\r\n        //}\r\n    },\r\n    _clearPokers : function () {\r\n        this._pokerNum = 0;\r\n        this._dict_pokerGroup = {};\r\n        var pokers = this.node.children;\r\n        this._list_hidePokers = [];\r\n        var comp, pokerNum = pokers.length;\r\n        for(var i = pokerNum-1; i >= 0; i --){\r\n            comp = pokers[i].getComponent(this._pokerCompName);\r\n            if(comp) this._removePoker(pokers[i]);\r\n        }\r\n    },\r\n\r\n    //获取初始位置\r\n    _getStartPos : function () {\r\n        if(!this._startPos){\r\n            this._startPos = G_DATA.getBottomTipPos();\r\n        }\r\n        return this._startPos\r\n    },\r\n    //获取当前有几组卡牌\r\n    _getGroupNum : function () {\r\n        return Math.floor(this._pokerNum/this._groupPokerNum)\r\n    },\r\n    //获取当前是否已经发完完整的牌\r\n    getIsGivePokerEnd : function () {\r\n        return !Boolean(this._coverPokerCallFunc)\r\n    },\r\n\r\n    //清理所有\r\n    clearAll : function () {\r\n        this._clearPokers();\r\n        this._dict_winList = null;\r\n        this.node.stopAllActions();\r\n    },\r\n\r\n    onDestroy : function () {\r\n        this._deletePokers();\r\n        if(this._pool) this._pool.clear();\r\n    },\r\n\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n"]}