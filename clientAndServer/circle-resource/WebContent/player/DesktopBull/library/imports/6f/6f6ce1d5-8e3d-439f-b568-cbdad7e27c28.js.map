{"version":3,"sources":["assets\\Script\\Objects\\Obj_scrollValue.js"],"names":["dataObj","startNum","targetNum","label","formatStr","callFunc","cc","Class","extends","Component","properties","_curLabel","_curNum","_maxNum","_formatStr","_callFunc","_isStartScroll","_interval","_maxScrollTimes","onLoad","scrollLabel","_initScrollData","Math","max","floor","_change","_showValue","_clearData","str","G_TOOL","changeMoney","string","forceEnd","update","dt"],"mappings":";;;;;;AAAA;;AAEA,IAAIA,UAAU;AACVC,cAAW,CADD;AAEVC,eAAY,CAFF;AAGVC,WAAQ,IAHE;AAIVC,eAAY,EAJF;AAKVC,cAAW;AALD,CAAd;;AAQAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,mBAAY,IADJ,EACgE;AACxEC,iBAAU,IAFF,EAEiE;AACzEC,iBAAU,IAHF,EAGiE;AACzEC,oBAAa,IAJL,EAIiE;AACzEC,mBAAY,IALJ,EAKiE;;AAEzEC,wBAAiB,IAPT,EAOiE;AACzEC,mBAAY,IARJ,EAQkE;AAC1EC,yBAAmB,IATX,EAHP;;AAeL;AACAC,YAAQ,kBAAY;AAChB,aAAKD,eAAL,GAAuB,EAAvB;AACA,aAAKF,cAAL,GAAsB,KAAtB;AACH,KAnBI;;AAqBL;AACAI,iBAAc,qBAAUpB,OAAV,EAAmB;AAC7B,YAAG,CAACA,OAAJ,EAAa;AACb,aAAKgB,cAAL,GAAsB,KAAtB;AACA,aAAKJ,OAAL,GAAeZ,QAAQC,QAAvB;AACA,aAAKY,OAAL,GAAeb,QAAQE,SAAvB;AACA,aAAKS,SAAL,GAAiBX,QAAQG,KAAzB;AACA,aAAKW,UAAL,GAAkBd,QAAQI,SAAR,GAAkB,IAApC;AACA,aAAKW,SAAL,GAAiBf,QAAQK,QAAzB;AACA,aAAKgB,eAAL;AACH,KA/BI;;AAiCLA,qBAAkB,2BAAY;AAC1B,aAAKJ,SAAL,GAAiBK,KAAKC,GAAL,CAASD,KAAKE,KAAL,CAAW,CAAC,KAAKX,OAAL,GAAe,KAAKD,OAArB,IAA8B,KAAKM,eAA9C,CAAT,EAAyE,CAAzE,CAAjB;AACA,aAAKF,cAAL,GAAsB,IAAtB;AACH,KApCI;;AAsCLS,aAAU,mBAAY;AAClB,aAAKb,OAAL,IAAgB,KAAKK,SAArB;AACA,YAAG,KAAKL,OAAL,IAAgB,KAAKC,OAAxB,EAAgC;AAC5B;AACA,iBAAKD,OAAL,GAAe,KAAKC,OAApB;AACA,iBAAKG,cAAL,GAAsB,KAAtB;AACH;AACD,aAAKU,UAAL;AACA,YAAG,CAAC,KAAKV,cAAT,EAAwB;AACpB,iBAAKW,UAAL;AACA,gBAAG,KAAKZ,SAAR,EAAkB;AACd,qBAAKA,SAAL;AACA,qBAAKA,SAAL,GAAiB,IAAjB;AACH;AACJ;AACJ,KArDI;;AAuDLW,gBAAa,sBAAY;AACrB,YAAIE,MAAMC,OAAOzB,SAAP,CAAiB,KAAKU,UAAtB,EAAkCe,OAAOC,WAAP,CAAmB,KAAKlB,OAAxB,CAAlC,CAAV;AACA,aAAKD,SAAL,CAAeoB,MAAf,GAAwBH,GAAxB;AACH,KA1DI;;AA4DLD,gBAAa,sBAAY;AACrB,aAAKf,OAAL,GAAe,CAAf;AACA,aAAKC,OAAL,GAAe,CAAf;AACA,aAAKF,SAAL,GAAiB,IAAjB;AACA,aAAKG,UAAL,GAAkB,EAAlB;AACA,aAAKG,SAAL,GAAiB,CAAjB;AACH,KAlEI;;AAoEL;AACAe,cAAW,oBAAY;AACnB,aAAKjB,SAAL,GAAiB,IAAjB;AACA,aAAKH,OAAL,GAAe,KAAKC,OAApB;AACH,KAxEI;;AA0EL;AACCoB,YAAQ,gBAAUC,EAAV,EAAc;AAClB,YAAG,CAAC,KAAKlB,cAAT,EAAyB;AACzB,aAAKS,OAAL;AACH;AA9EG,CAAT","file":"unknown","sourcesContent":["//滚动数字的通用脚本\r\n\r\nvar dataObj = {\r\n    startNum : 0,\r\n    targetNum : 1,\r\n    label : null,\r\n    formatStr : '',\r\n    callFunc : null\r\n}\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        _curLabel : null,                                                       //当前使用的滚动label\r\n        _curNum : null,                                                          //当前的滚动值\r\n        _maxNum : null,                                                          //最大的滚动值\r\n        _formatStr : null,                                                       //需要组合显示的字符串\r\n        _callFunc : null,                                                        //滚动结束后的回调\r\n\r\n        _isStartScroll : null,                                                   //是否开始滚动\r\n        _interval : null,                                                         //滚动间隔\r\n        _maxScrollTimes :  null,                                                 //最大的滚动次数\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        this._maxScrollTimes = 50;\r\n        this._isStartScroll = false;\r\n    },\r\n\r\n    //开始滚动数值\r\n    scrollLabel : function (dataObj) {\r\n        if(!dataObj) return;\r\n        this._isStartScroll = false;\r\n        this._curNum = dataObj.startNum;\r\n        this._maxNum = dataObj.targetNum;\r\n        this._curLabel = dataObj.label;\r\n        this._formatStr = dataObj.formatStr+'%s';\r\n        this._callFunc = dataObj.callFunc;\r\n        this._initScrollData();\r\n    },\r\n\r\n    _initScrollData : function () {\r\n        this._interval = Math.max(Math.floor((this._maxNum - this._curNum)/this._maxScrollTimes), 0);\r\n        this._isStartScroll = true;\r\n    },\r\n\r\n    _change : function () {\r\n        this._curNum += this._interval;\r\n        if(this._curNum >= this._maxNum){\r\n            //已经滚动到最大值\r\n            this._curNum = this._maxNum;\r\n            this._isStartScroll = false;\r\n        }\r\n        this._showValue();\r\n        if(!this._isStartScroll){\r\n            this._clearData();\r\n            if(this._callFunc){\r\n                this._callFunc();\r\n                this._callFunc = null;\r\n            }\r\n        }\r\n    },\r\n\r\n    _showValue : function () {\r\n        var str = G_TOOL.formatStr(this._formatStr, G_TOOL.changeMoney(this._curNum));\r\n        this._curLabel.string = str;\r\n    },\r\n\r\n    _clearData : function () {\r\n        this._curNum = 0;\r\n        this._maxNum = 0;\r\n        this._curLabel = null;\r\n        this._formatStr = '';\r\n        this._interval = 0;\r\n    },\r\n\r\n    //强制结束,显示最终结果\r\n    forceEnd : function () {\r\n        this._callFunc = null;\r\n        this._curNum = this._maxNum;\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n     update: function (dt) {\r\n         if(!this._isStartScroll) return;\r\n         this._change();\r\n     },\r\n});\r\n"]}